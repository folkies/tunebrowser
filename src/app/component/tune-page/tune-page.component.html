<div class="player-controls">
    <div class="player">
        <app-tune-player #player [tune]="tune"></app-tune-player>
    </div>
    <div class="tempo-slider">
        <mat-label class="mat-body tempo-label">Tempo {{player.tempo}}</mat-label>
        <mat-slider thumbLabel [min]="50" [max]="200" color="accent">
            <input matSliderThumb [(ngModel)]="player.tempo"/>
        </mat-slider>
    </div>
</div>
<app-tune-view [tune]="tuneForDisplay()"></app-tune-view>

<form class="tags-form">
    <mat-form-field class="tags">
        <input name="tags" matInput [(ngModel)]="allTags" placeholder="Tags" [readOnly]="!signedIn">
    </mat-form-field>

    <button mat-raised-button (click)="save()" label="Save" class="search-button" color="primary"
        [disabled]="!signedIn">Save</button>

</form>

<button mat-raised-button (click)="openDialog()" class="repertoire-button" color="primary"
[disabled]="!signedIn">Add to repertoire</button>

<button mat-raised-button (click)="exportAsPdf()" class="tune-button" color="primary"><mat-icon>print</mat-icon></button>

<button mat-raised-button routerLink="../{{prevRef}}" class="tune-button" color="primary"
[disabled]="!prevRef">Previous tune</button>

<button mat-raised-button routerLink="../{{nextRef}}" class="tune-button" color="primary"
[disabled]="!nextRef">Next tune</button>
@if (signedIn && (containingSets.length > 0 || containingRepertoires.length > 0)) {
  <div class="containing-collections">
    <h3 class="mat-h3">This tune appears in:</h3>
    
    @if (containingSets.length > 0) {
      <div class="containing-section">
        <h4 class="mat-body-strong">Tune Sets:</h4>
        <ul>
          @for (set of containingSets; track set.id) {
            <li class="mat-body">
              <a routerLink="/set/{{set.id}}">{{set.name}}</a>
            </li>
          }
        </ul>
      </div>
    }
    
    @if (containingRepertoires.length > 0) {
      <div class="containing-section">
        <h4 class="mat-body-strong">Repertoires:</h4>
        <ul>
          @for (repertoire of containingRepertoires; track repertoire.name) {
            <li class="mat-body">
              <a routerLink="/repertoire/{{repertoire.name}}">{{repertoire.name}}</a>
            </li>
          }
        </ul>
      </div>
    }
  </div>
}